(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{144:function(e,t,n){},146:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),o=n(6),r=n.n(o),s=(n(81),n(39)),u=n(11),h=n(12),c=n(29),l=n(27),d=n(30),p=n(57),v=(n(144),n(15)),f=function(e){function t(){var e,n;Object(u.a)(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).state={width:4,height:5,defaultLayout:0},n.handleRadioButtonChange=function(e){n.setState({defaultLayout:Number(e.target.id)})},n.handleChange=function(e){var t=Number(e.target.value);("width"===e.target.name&&t>=4||"height"===e.target.name&&t>=5)&&n.setState(Object(s.a)({},e.target.name,t))},n}return Object(d.a)(t,e),Object(h.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault()}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"App"},a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement("div",null,a.a.createElement("label",null,"Width:",a.a.createElement("input",{type:"number",name:"width",value:this.state.width,onChange:this.handleChange})),a.a.createElement("label",null,"Height:",a.a.createElement("input",{type:"number",name:"height",value:this.state.height,onChange:this.handleChange}))),a.a.createElement("h3",null,"Choose your layout"),a.a.createElement("div",null,v.d.map(function(t,n){return a.a.createElement("div",{style:{display:"inline-block",margin:16},key:n},a.a.createElement(p.a,{width:e.state.width,height:e.state.height,pieces:t}),a.a.createElement("div",null,a.a.createElement("input",{type:"radio",name:"layout",id:n,checked:n===e.state.defaultLayout,onChange:e.handleRadioButtonChange})))}))),a.a.createElement("hr",{style:{backgroundColor:"#fff",borderTop:"2px dashed #8c8b8b",margin:16}}),a.a.createElement("div",{style:{margin:32}},a.a.createElement(p.b,{width:this.state.width,height:this.state.height,defaultLayout:this.state.defaultLayout})))}}]),t}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(a.a.createElement(f,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},15:function(e,t,n){"use strict";n.d(t,"c",function(){return u}),n.d(t,"d",function(){return p}),n.d(t,"b",function(){return y}),n.d(t,"a",function(){return m});var i=n(11),a=n(12),o=n(143),r={LEFT:0,UP:1,RIGHT:2,DOWN:3},s=Object.keys(r).reduce(function(e,t){return e[r[t]]=t,e},{}),u={BLOCK:0,V2:1,H2:2,CUBE:3,EMPTY:4,BOARDER:5};function h(e){switch(e){case u.BLOCK:return"BL";case u.V2:return"V2";case u.H2:return"H2";case u.CUBE:return"CB";case u.EMPTY:return"O ";case u.BOARDER:return"X ";default:return"! "}}var c=function(){function e(t,n){Object(i.a)(this,e),this.left=t,this.top=n}return Object(a.a)(e,[{key:"copy",value:function(){return new e(this.left,this.top)}},{key:"moveTo",value:function(e){switch(e){case r.LEFT:return this.moveLeft();case r.RIGHT:return this.moveRight();case r.UP:return this.moveUp();case r.DOWN:return this.moveDown();default:throw new Error("Unknown direction to move to: ".concat(e))}}},{key:"equals",value:function(e){return this.left===e.left&&this.top===e.top}},{key:"moveLeft",value:function(){return this.left--,this}},{key:"moveRight",value:function(){return this.left++,this}},{key:"moveUp",value:function(){return this.top--,this}},{key:"moveDown",value:function(){return this.top++,this}},{key:"lessThan",value:function(e){return this.top<e.top||!(this.top>e.top)&&this.left<e.left}}]),e}(),l=new c(1,3),d=function(){function e(t,n,a,o){Object(i.a)(this,e),this.id=a,this.name=o,this.type=t,this.position=n}return Object(a.a)(e,[{key:"moveTo",value:function(e){this.position.moveTo(e)}},{key:"copy",value:function(){return new e(this.type,this.position.copy(),this.id,this.name)}},{key:"copyDumbPiece",value:function(){return new e(this.type,this.position.copy())}},{key:"copyMirrorDumbPiece",value:function(t){var n=this.position.copy();return this.type===u.H2||this.type===u.CUBE?n.left=t-2-n.left:n.left=t-1-n.left,new e(this.type,n)}},{key:"canBeReplacedBy",value:function(e){return this.isEmpty()||this.equals(e)}},{key:"isEmpty",value:function(){return this.type===u.EMPTY}},{key:"equals",value:function(e){return this.id&&this.id===e.id}},{key:"lessThan",value:function(e){return this.type<e.type||!(this.type>e.type)&&this.position.lessThan(e.position)}}]),e}(),p=[[new d(u.V2,new c(0,0),0,"zf"),new d(u.CUBE,new c(1,0),1,"cc"),new d(u.V2,new c(3,0),2,"mc"),new d(u.V2,new c(0,2),3,"zy"),new d(u.H2,new c(1,2),4,"gy"),new d(u.V2,new c(3,2),5,"hz"),new d(u.BLOCK,new c(0,4),6,"b"),new d(u.BLOCK,new c(1,3),7,"b"),new d(u.BLOCK,new c(2,3),8,"b"),new d(u.BLOCK,new c(3,4),9,"b")],[new d(u.V2,new c(0,0),0,"zf"),new d(u.CUBE,new c(1,0),1,"cc"),new d(u.V2,new c(3,0),2,"gy"),new d(u.BLOCK,new c(0,2),3,"b"),new d(u.H2,new c(1,2),4,"zy"),new d(u.BLOCK,new c(3,2),5,"b"),new d(u.V2,new c(0,3),6,"hz"),new d(u.BLOCK,new c(1,3),7,"b"),new d(u.BLOCK,new c(2,3),8,"b"),new d(u.V2,new c(3,3),9,"mc")],[new d(u.BLOCK,new c(0,0),0,"b"),new d(u.CUBE,new c(1,0),1,"cc"),new d(u.BLOCK,new c(3,0),2,"b"),new d(u.V2,new c(0,1),3,"zf"),new d(u.H2,new c(1,2),4,"zy"),new d(u.V2,new c(3,1),5,"gy"),new d(u.V2,new c(0,3),6,"hz"),new d(u.BLOCK,new c(1,3),7,"b"),new d(u.BLOCK,new c(2,3),8,"b"),new d(u.V2,new c(3,3),9,"mc")]],v=function(){function e(t,n){if(Object(i.a)(this,e),parseInt(t)!==+t)throw new Error("value of width is invalid:  ",t);if(parseInt(n)!==+n)throw new Error("value of height is invalid: ",n);this.width=t,this.height=n,this.piecesPlaced=!1,this.initBoard()}return Object(a.a)(e,[{key:"initBoard",value:function(){for(var e=[],t=0;t<this.height+2;t++){e.push([]);for(var n=0;n<this.width+2;n++){var i=new c(t,n),a=null;a=0===t||0===n||t===this.height+1||n===this.width+1?new d(u.BOARDER,i):new d(u.EMPTY,i),e[t][n]=a}}return this.board=e,e}},{key:"initPieces",value:function(e,t){var n=this;if(!Array.isArray(e))throw new Error("pieces should be an array!");this.pieces=e,this.cubeIndex=t,this.cube=this.pieces[t],e.forEach(function(e,t){if(!n.canAddPieceToBoard(e)){var i="Piece of index ".concat(t," could not be put on board");throw console.log(i),new Error(i)}n.addPieceToBoard(e)}),this.piecesPlaced=!0}},{key:"equals",value:function(e){for(var t=0;t<this.height;t++)for(var n=0;n<this.width;n++){var i=this.getPiece(new c(n,t)),a=e.getPiece(new c(n,t));if(i.type!==a.type)return this.printBoard(),e.printBoard(),!1}return!0}},{key:"getPiece",value:function(e){return this.board[e.top+1][e.left+1]}},{key:"isResolved",value:function(){return this.cube.position.equals(l)}},{key:"canAddPieceToBoard",value:function(e,t){var n=t||e.position;n=n.copy();var i=this.getPiece(n).canBeReplacedBy(e);if(!i)return!1;var a=this.getPiece(n.moveRight()),o=this.getPiece(n.moveDown()),r=this.getPiece(n.moveLeft());switch(e.type){case u.BLOCK:return i;case u.H2:return a.canBeReplacedBy(e);case u.V2:return r.canBeReplacedBy(e);case u.CUBE:return a.canBeReplacedBy(e)&&r.canBeReplacedBy(e)&&o.canBeReplacedBy(e);default:return!1}}},{key:"addPieceToBoard",value:function(e){var t=e.position,n=t.left,i=t.top;switch(e.type){case u.BLOCK:this.board[i+1][n+1]=e;break;case u.H2:this.board[i+1][n+1]=e,this.board[i+1][n+2]=e;break;case u.V2:this.board[i+1][n+1]=e,this.board[i+2][n+1]=e;break;case u.CUBE:this.board[i+1][n+1]=e,this.board[i+1][n+2]=e,this.board[i+2][n+2]=e,this.board[i+2][n+1]=e;break;default:return!1}return!0}},{key:"canPieceMoveTo",value:function(e,t){var n=this.pieces[e];return this.canAddPieceToBoard(n,n.position.copy().moveTo(t))}},{key:"clearRectangle",value:function(e,t){for(var n=e.top;n<=t.top;n++)for(var i=e.left;i<=t.left;i++)this.board[n+1][i+1]=new d(u.EMPTY,new c(i,n))}},{key:"clearPiece",value:function(e){var t=e.position;switch(e.type){case u.BLOCK:this.clearRectangle(t,t);break;case u.V2:this.clearRectangle(t,t.copy().moveDown());break;case u.H2:this.clearRectangle(t,t.copy().moveRight());break;case u.CUBE:this.clearRectangle(t,t.copy().moveRight().moveDown());break;default:throw new Error("Unknow piece type: ".concat(e.type))}}},{key:"movePieceTo",value:function(e,t){var n=this.pieces[e];return this.clearPiece(n),n.moveTo(t),this.addPieceToBoard(n),!0}},{key:"getZobristHash",value:function(e){var t=0;return this.pieces.forEach(function(n){t^=e[n.position.top][n.position.left][n.type]}),t}},{key:"getMirrorZobristHash",value:function(e){for(var t=0,n=0;n<this.height;n++)for(var i=0;i<this.width;i++)t^=e[n][i][this.getPiece(new c(i,n)).copyMirrorDumbPiece().type];return t}},{key:"getPieceHash",value:function(){var e=this.pieces.map(function(e){return e.copyDumbPiece()});return o(e.sort(function(e,t){return e.lessThan(t)}))}},{key:"getMirrorPieceHash",value:function(){var e=this,t=this.pieces.map(function(t){return t.copyMirrorDumbPiece(e.width)});return o(t.sort(function(e,t){return e.lessThan(t)}))}},{key:"getHash",value:function(e){return this.hash?this.hash:(this.hash=this.getZobristHash(e),this.hash)}},{key:"getMirrorHash",value:function(e){return this.mirrorHash?this.mirrorHash:(this.mirrorHash=this.getMirrorZobristHash(e),this.mirrorHash)}},{key:"printBoard",value:function(){for(var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=0;t<this.height+2;t++){for(var n="",i=0;i<this.width+2;i++)n=n+(e?h(this.board[t][i].type):void 0===this.board[t][i].id?-1:this.board[t][i].id)+" ";console.log(n)}}}]),e}(),f=function e(t,n,a){Object(i.a)(this,e),this.pieceIndex=t,this.direction=n,this.length=a},y=function(){function e(t,n){var a=this;Object(i.a)(this,e),this.tryToMovePiece=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(a.canPieceMoveTo(e,t)){var i=a.copy();return i.movePieceTo(e,t),i.parent=a,i.step++,i.move=new f(e,t,1),n&&(i.parent=a.parent,i.step--,i.move=new f(e,t,2)),i}return null},this.board=new v(t,n),this.parent=null,this.step=0,this.move=null,this.width=t,this.height=n}return Object(a.a)(e,[{key:"getBoardWidth",value:function(){return this.width}},{key:"getBoardHeight",value:function(){return this.height}},{key:"getPieces",value:function(){return this.board.pieces}},{key:"getPiece",value:function(e){return this.board.pieces[e]}},{key:"isResolved",value:function(){return this.board.isResolved()}},{key:"initPosition",value:function(e,t){return this.cubeIndex=t,this.board.initPieces(e,t)}},{key:"copy",value:function(){var t=new e(this.width,this.height),n=this.board.pieces.map(function(e){return e.copy()});return t.initPosition(n,this.cubeIndex),t}},{key:"printCubePosition",value:function(){console.log("Cube position is: ",this.getPiece(this.cubeIndex).position)}},{key:"canPieceMoveTo",value:function(e,t){return this.board.canPieceMoveTo(e,t)}},{key:"movePieceTo",value:function(e,t){return this.board.movePieceTo(e,t)}},{key:"printMove",value:function(){console.log("Moving pieace: ".concat(this.getPiece(this.move.pieceIndex).name," ").concat(s[this.move.direction]," ").concat(this.move.length," step(s)"))}},{key:"printGamePosition",value:function(){this.board.printBoard()}},{key:"getHash",value:function(e){return this.board.getHash(e)}},{key:"getMirrorHash",value:function(e){return this.board.getMirrorHash(e)}},{key:"reversePlay",value:function(){for(var e=[],t=this;null!==t.parent;)e.unshift(t),t=t.parent;return e}}]),e}();var m=function(){function e(t){var n=this;Object(i.a)(this,e),this.findSolution=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;for(n.index=0,n.startTime=Date.now();n.index<n.positions.length;){var t=n.positions[n.index];if(t.isResolved()){if(n.solutionCounts++,n.solutions.push(t.getHash()),n.solutionCounts>=e)return}else n.bfsSearchSolution(t);n.index++}},this.bfsSearchSolution=function(e){e.getPieces().forEach(function(t,i){Object.keys(r).forEach(function(t){var a=e.tryToMovePiece(i,r[t]);if(a){n.upsertState(a);var o=a.tryToMovePiece(i,r[t],!0);o&&n.upsertState(o)}})})},this.initialPosition=t,this.positions=[t],this.solutions=[],this.solutionCounts=0,this.memories={},this.index=0,this.zobristHash=function(e,t,n){for(var i=[],a=0;a<t;a++){i.push([]);for(var o=0;o<e;o++){i[a].push([]);for(var r=0;r<Object.keys(n).length;r++){for(var s=0;!s;)s=Math.floor(Math.random()*Math.pow(2,31));i[a][o].push(s)}}}return i}(t.getBoardWidth(),t.getBoardHeight(),u)}return Object(a.a)(e,[{key:"upsertState",value:function(e){return this.memories[e.getHash(this.zobristHash)]?null:(this.positions.push(e),this.memories[e.getHash(this.zobristHash)]=e,this.memories[e.getMirrorHash(this.zobristHash)]=e,e.getHash(this.zobristHash))}},{key:"hasSolution",value:function(){return 0!==this.solutions.length}},{key:"isCalculated",value:function(){return this.index>=this.positions.length}},{key:"getSolution",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return 0===this.solutions.length?null:(this.plays=this.memories[this.solutions[e]].reversePlay(),this.plays)}}]),e}()},57:function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return m}),n.d(t,"a",function(){return g});var i=n(58),a=n(11),o=n(12),r=n(29),s=n(27),u=n(30),h=n(1),c=n.n(h),l=n(59),d=(n(141),n(15)),p=l.a.createSliderWithTooltip(l.a),v=100,f={solving:"Solving...",playing:"Pause",paused:"Continue",finished:"Reinitialize",undefined:"Solve",solved:"Play"},y=400,m=function(t){function n(t){var o;Object(a.a)(this,n),(o=Object(r.a)(this,Object(s.a)(n).call(this,t))).handleAfterChange=function(t){o.setState({playbackSpeed:t}),e(function(){"paused"===o.state.autoPlayState&&o.playGame()})},o.handlePlay=function(){var e=o.state,t=e.game,n=e.autoPlayState;void 0!==n||t.isCalculated()||(o.setState({autoPlayState:"solving"}),setTimeout(function(){t.findSolution(),o.setState({autoPlayState:"solved",iteration:t.index})},200)),"solving"!==n&&("solved"===n?o.playGame():"playing"===n?o.pauseGame():"paused"===n?o.playGame():"finished"===n&&o.setState({intervalHandle:void 0,autoPlayState:"solved",step:0}))},o.handleNext=function(){var e=o.state,t=e.autoPlayState,n=e.step,i=e.game.getSolution();!i||"paused"!==t&&"solved"!==t||(n<i.length-1?o.setState({step:n+1}):o.setState({autoPlayState:"finished"}))},o.handlePrevious=function(){var e=o.state,t=e.autoPlayState,n=e.step;"finished"===t?o.setState({step:n-1,autoPlayState:"paused"}):"paused"===t&&(n>0?o.setState({step:n-1}):o.setState({autoPlayState:"solved"}))},o.frameSolve=function(){for(var e=0,t=o.state.game;e<v&&t.index<t.positions.length;){var n=t.positions[t.index];if(n.isResolved()){if(t.solutionCounts++,t.solutions.push(n.getHash()),t.solutionCounts>=3)return}else t.bfsSearchSolution(n);o.setState({iteration:t.index}),t.index++,e++}t.index>=t.positions.length?o.setState({autoPlayState:"solved"}):requestAnimationFrame(o.frameSolve)},o.playGame=function(){var e=o.state,t=e.game,n=e.step,i=t.getSolution();if(!i)return alert("No solution found!");var a=setInterval(function(){n<i.length?(o.setState({step:n}),n++):(a&&clearInterval(a),o.setState({intervalHandle:void 0,autoPlayState:"finished"}))},o.state.playbackSpeed);o.setState({intervalHandle:a,autoPlayState:"playing",step:n})},o.pauseGame=function(){var e=o.state.intervalHandle;e&&clearInterval(e),"playing"===o.state.autoPlayState&&o.setState({intervalHandle:void 0,autoPlayState:"paused"})},o.getBoardToRender=function(){var e=o.state,t=e.autoPlayState,n=e.step,i=e.game.getSolution();return"playing"===t||"paused"===t?i[n].getPieces():"finished"===t?i[i.length-1].getPieces():o.state.initialPieces};var u=o.initializeGame();return o.state=Object(i.a)({playbackSpeed:y},u),o}return Object(u.a)(n,t),Object(o.a)(n,[{key:"initializeGame",value:function(){var e=d.d[this.props.defaultLayout],t=new d.b(this.props.width,this.props.height);return t.initPosition(e,1),{game:new d.a(t),initialPieces:e,iteration:0,step:0,solving:!1,autoPlayState:void 0}}},{key:"componentDidUpdate",value:function(e,t){if(this.props.width!==e.width||this.props.height!==e.height||this.props.defaultLayout!==e.defaultLayout){var n=this.initializeGame();this.setState(Object(i.a)({},n))}}},{key:"render",value:function(){var e=this.state.autoPlayState;return c.a.createElement("div",null,c.a.createElement(g,{width:this.props.width,height:this.props.height,pieces:this.getBoardToRender()}),c.a.createElement("div",null,c.a.createElement("div",{style:{margin:16}},c.a.createElement("span",{style:{margin:16}},"Iterations: ",this.state.iteration),c.a.createElement("span",null,this.state.step?"Steps: ".concat(this.state.step):null)),c.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",margin:32}},c.a.createElement("div",null,"Playback speed: "),c.a.createElement(p,{railStyle:{backgroundColor:"#c7ccca"},trackStyle:{backgroundColor:"transparent"},activeDotStyle:{backgroundColor:"transparent"},onBeforeChange:this.pauseGame,onAfterChange:this.handleAfterChange,min:0,max:600,step:10,defaultValue:this.state.playbackSpeed,marks:{100:"100",200:"200",300:"300ms",400:"400",500:"500"}})),c.a.createElement("div",null,c.a.createElement("button",{className:"control previous",onClick:this.handlePrevious},"\u276e"),c.a.createElement("button",{className:"control play round",id:"solveBtn",onClick:this.handlePlay,disabled:"solving"===e},f[e]),c.a.createElement("button",{className:"control next",onClick:this.handleNext},"\u276f"))))}}]),n}(h.PureComponent);m.width=200,m.height=250;var g=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"renderBlocks",value:function(){var e=this.props.pieces,t=m.width/this.props.width,n=m.height/this.props.height;return e.map(function(e){return c.a.createElement(b,{gamePiece:e,blockHeight:n,blockWidth:t,key:e.id})})}},{key:"render",value:function(){return c.a.createElement("div",{id:"frame"},this.renderBlocks())}}]),t}(h.PureComponent),b=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.blockHeight,n=e.blockWidth,i=e.gamePiece,a=1,o=1,r=i.position.left,s=i.position.top,u=["block"];i.type===d.c.H2?(a=2,u.push("h2")):i.type===d.c.CUBE?(a=2,o=2,u.push("cube")):i.type===d.c.V2?(o=2,u.push("v2")):u.push("blk");var h={height:o*t,width:a*n,left:r*n,top:s*t};return c.a.createElement("div",{className:u.join(" "),style:h})}}]),t}(h.PureComponent)}).call(this,n(83).setImmediate)},76:function(e,t,n){e.exports=n(146)},81:function(e,t,n){}},[[76,2,1]]]);
//# sourceMappingURL=main.1e8dbb02.chunk.js.map